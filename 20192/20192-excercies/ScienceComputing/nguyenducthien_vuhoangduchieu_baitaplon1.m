clear; clc;figure(5);% Data input ngay = [0 0.25 0.5 1 2 3 4 5 6 8 10];khoiluong = [2.5 3.6 5.3 9.5 14 16.5 18.8 21.5 23.2 26.8 28.4];plot(ngay,khoiluong,'ro');day_predict = [10:21];legend('Data');% Polynomial Model function [p res sum_err] = polynomialModel(x,y,order);  p = polyfit(x,y,order);     v = polyval(p,x);           ngay_predict = [11:21];   khoiluong_predict = polyval(p,ngay_predict);    figure(order);    plot(x,y,'ro'); % Plot data   hold on;  plot(x,v,'b-'); % Plot Model  hold on;  plot(ngay_predict,khoiluong_predict,'bo'); % Plot predict   hold on;  test_ngay = [12,16,21];  test_khoiluong = [28.4,28.5,29.5];  plot(test_ngay,test_khoiluong,'go'); % Plot test data  hold on;  legend('Data','Model','Predict','Test Model');  res = v-y;  bar(x,res);  sum_err = sum(res.^2);  hold off;endfunction;% Test 1st, 2nd, 3rd order for order=1:3  [p res sum_err] = polynomialModel(ngay,khoiluong,order);  fprintf('Parameters of %d order model: ',order);  p'   fprintf('Residual of each data point: ');  res'  fprintf('Sum of square of residual of each data point: %f\n',sum_err);  fprintf('=============================\n');endfor;% Exponential Model function [value] = Y(C,a,t)  value = C*(1-exp(-a*t));endfunction;  % Sum of square of residual function function sumErr = errFun(param)  ngay = [0 0.25 0.5 1 2 3 4 5 6 8 10];  khoiluong = [2.5 3.6 5.3 9.5 14 16.5 18.8 21.5 23.2 26.8 28.4];  sumErr = 0;  for i=1:10    sumErr = sumErr + (Y(param(1),param(2),ngay(i)) - khoiluong(i)).^2;  endfor;endfunction;%Init param C = 10;a = 2;[x fval] = fminsearch(@errFun,[C a]);C = x(1);a = x(2);fprintf('Value of C & a calculated by fminsearch: C = %f; a = %f \n',C,a);fprintf('Local minimum of sum of square of residual function: %f \n',fval);model = @(t) C*(1-exp(-a*t));% Plotfigure(4);plot(ngay,khoiluong,'ro'); % Plot Datahold on;fplot(model,[0 21]); % Plot Exponential Model hold on;ngay_predict = [11:21];khoiluong_predict = model(ngay_predict);plot(ngay_predict,khoiluong_predict,'bo'); % Plot predict hold on;test_ngay = [12,16,21];test_khoiluong = [28.4,28.5,29.5];plot(test_ngay,test_khoiluong,'go'); % Plot test datahold on;legend('Data','Model','Predict','Test Model');