clear, clc;b = zeros(1,5);n = 4;global g te ye h;g = 9.8;c = 9.8;te = 5;ye = 40;h = te/n;A(1,1:2) = [.5 .5]b(1) = 0;A(2,1:4) = [4 -7 2 1];b(2) = -5.*g.*h.^2;for i = 3:n  A(i, i-2:i+2) = [1 2 -6 2 1];  b(i) = -6*g*h^2;endA(n+1, n-1:n+2) = [1 2 -7 4]; % last interior interval b(n+1) = -5*g*h^2;A(n+2, n+1:n+2) = [.5 .5];b(n+2) = ye;b= b';u = A\b;Ab'u'(u(2)-u(1))/hplot(-h/2:h:te+h/2, u, 'g'); % plot the coefficientstv = 0:h/8:te;yv = [];for t = tv  i = floor(t/h)+2;  if i==n+2    i = n+1;  endif    x = t/h-i+1.5;  y = u(i-1)*.5*(x-.5)^2 + u(i)*(.75-x^2) + u(i+1)*.5*(x+.5)^2;   yv = [yv y];end% compute joints between elements tk = (0:h:te)';yk = .5*(u(1:n+1)+u(2:n+2));hold off;set(gca, 'FontSize', 16); % for tick marks plot(tv,yv,'b', tk,yk,'bo', 'LineWidth',2);xlabel('t', 'FontSize',20);ylabel('y', 'FontSize',20);axis([0 5 0 60]);title('Galerkin Finite Element Method', 'FontSize',20);

