clear;clc;g = 10;f = 0.00001;function [dfx dfy] = d_dx_dy(f,dx,dy)  [nx ny] = size(f);  dfx = zeros(nx,ny);  dfy = zeros(nx,ny);  for i=1:nx    for j=1:ny      if i==1        dfx(i,j) = (f(i+1,j) - f(nx,j))/2/dx;      elseif i==nx        dfx(i,j) = (f(1,j) - f(i-1,j))/2/dx;      else        dfx(i,j) = (f(i+1,j) - f(i-1,j))/2/dx;       endif              if j==1        dfy(i,j) = (f(i,j+1) - f(i,ny))/2/dy;      elseif j==ny        dfy(i,j) = (f(i,1) - f(i,j-1))/2/dy;      else        dfy(i,j) = (f(i,j+1) - f(i,j-1))/2/dy;      endif    endfor;  endfor;  endfunction  box_size = 1;nx = 100;ny = 100;dx = box_size/nx;dy = box_size/ny;u = zeros(nx,ny);v = zeros(nx,ny);h = ones(nx,ny)*2;h(30:40,30:40) = 2.1;T = 1;dt = 0.01;t = 0;while t<T  t = t + dt;    [dhx dhy] = d_dx_dy(h,dx,dy);  [duhx duhy] = d_dx_dy(u.*h,dx,dy);  [dvhx dvhy] = d_dx_dy(v.*h,dx,dy);    du_dt = -g*dhx + f*v;  dv_dt = -g*dhy - f*u;  dh_dt = - duhx - dvhy;    h = h + dh_dt * dt;  u = u + du_dt * dt;  v = v + dv_dt * dt;  mesh(h);  pause(0.001);  endwhile;